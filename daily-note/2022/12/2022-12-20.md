# 컴퓨터 구조

## Case/Switch

* 대부분의 프로그래밍 언어에 있는 다중 분기 명령어.

### 효율적인 구현 방법.

* 여러 코드의 시작 주소를 표로 만듦.
* 점프 주소 테이블(jump address table) 또는 점프 테이블(jump table)의 인덱스를 계산해서 해당 루틴으로 점프.
    * 여러 명령어 시퀀스의 주소를 가지고 있는 표.
* 프로그램은 점프 테이블에 저장된 주소를 레지스터에 적재하고 해당 주소를 사용해서 점프.
    * MIPS에서 jr(jump register) 명령어 제공.
    * jr은 레지스터에 저장된 주소로 무조건 점프함.

## 프로시저

* 프로시저나 함수는 재사용 가능하도록 프로그램을 구조화하는 방법 중의 하나.
    * 한 번에 한 부분씩 집중해서 처리할 수 있도록 도와줌.
* 소프트웨어에서 추상화를 구현하는 방법 중 하나.
* 인수(parameter)를 프로시저에 보내서 결과를 받아옴.

### 프로시저 동작 방식

1. 프로시저가 접근할 수 있는 곳에 인수를 넣음.
2. 프로시저로 제어를 넘김.
3. 프로시저가 필요로 하는 메모리 자원을 획득.
4. 필요한 작업 수행.
5. 호출한 프로그램이 접근할 수 있는 장소에 결과값 저장.
6. 원래 위치로 제어를 돌려줌.

### 레지스터 할당

* \$a0 ~ \$a3 : 인수 레지스터 4개
* \$v0 ~ \$v1 : 반환되는 값을 갖게 되는 값 레지스터 4개
* \$ra: 호출한 곳으로 되돌아갈 복귀 주소를 가지고 있는 레지스터 1개

### jal(jump-and-link) 명령어

* 프로시저를 위해 MIPS에서 제공하는 명령어.
* 지정된 주소로 점프하면서 다음 명령어의 주소를 $ra 레지스터에 저장하는 명령어.
* \$ra에 호출한 곳으로 되돌아갈 복귀 주소(return address)가 저장됨.

#### 동작 순서

1. \$a0~\$a3에 전달할 인자를 저장.
2. jal X (프로시저 X로 점프).
3. 처리 후 \$v0 ~ \$v1에 값 저장.
4. jr \$ra 명령어로 호출한 곳으로 되돌아감.

### 프로그램 카운터(program counter, pc)

* 현재 실행 중인 명령어의 주소를 기억하는 레지스터.
* jal 명령은 프로시저에서 복귀때 다음 명령어부터 실행하도록 PC + 4를 레지스터 $ra에 저장.